{"ast":null,"code":"import _defineProperty from\"/Users/khanglethanh/fullstack_open/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/khanglethanh/fullstack_open/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/khanglethanh/fullstack_open/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import ReactDOM from'react-dom';import Filter from'./component/Filter';import PersonForm from'./component/PersonForm';import Persons from'./component/Persons';import Notification from'./component/Notification';import personService from'./services/persons';import'./index.css';var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState({name:\"\",number:\"\"}),_useState4=_slicedToArray(_useState3,2),newInfo=_useState4[0],setNewInfo=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),filterName=_useState6[0],setFilterName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),successMessage=_useState8[0],setSuccessrMessage=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];useEffect(function(){console.log('effect');setSuccessrMessage(null);setErrorMessage(null);personService.getAll().then(function(initialPersons){setPersons(initialPersons);});},[]);var handleFilter=function handleFilter(newValue){setFilterName(newValue);};var handleChange=function handleChange(event){var value=event.target.value;setNewInfo(_objectSpread({},newInfo,_defineProperty({},event.target.name,value)));};var addPerson=function addPerson(event){event.preventDefault();if(newInfo.name!==undefined){if(persons.some(function(person){return person.name===newInfo.name;})){var answer=window.confirm(\"\".concat(newInfo.name,\" is already added to phonebook, replace the old number with a new one?\"));var person=persons.find(function(n){return n.name===newInfo.name;});var changedInfo=_objectSpread({},person,{number:newInfo.number});if(answer===true){personService.update(changedInfo.id,changedInfo).then(function(returnedPerson){setPersons(persons.map(function(person){return person.id!==changedInfo.id?person:returnedPerson;}));setSuccessrMessage(\"User \".concat(newInfo.name,\" has changed number to: \").concat(newInfo.number));setTimeout(function(){setSuccessrMessage(null);},5000);}).catch(function(error){console.log(error);setPersons(persons.filter(function(person){return person.id!==changedInfo.id;}));setErrorMessage(\"Information of \".concat(newInfo.name,\" has already been removed from server\"));setTimeout(function(){setErrorMessage(null);},5000);});}}else{var personObject={name:newInfo.name,number:newInfo.number};personService.create(personObject).then(function(returnedPerson){console.log(\"i\");setPersons(persons.concat(returnedPerson));setNewInfo('');setSuccessrMessage(\"Added \".concat(newInfo.name));setTimeout(function(){setSuccessrMessage(null);},5000);}).catch(function(error){console.log(error.response.data.error);setErrorMessage(error.response.data.error);});}}};var _removedPerson=function removedPerson(id){var person=persons.find(function(person){return person.id===id;});var deletedPerson=_objectSpread({},person);personService.deleteId(id,deletedPerson).then(function(returnedPerson){setPersons(persons.map(function(person){return person.id!==id?person:returnedPerson;}).filter(function(value){return Object.keys(value).length!==0;}));});};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Phonebook\"),/*#__PURE__*/React.createElement(Notification,{success_message:successMessage,error_message:errorMessage}),/*#__PURE__*/React.createElement(Filter,{value:filterName,onChange:handleFilter}),/*#__PURE__*/React.createElement(\"h2\",null,\"add a new\"),/*#__PURE__*/React.createElement(PersonForm,{values:newInfo,onChange:handleChange,onSubmit:addPerson}),/*#__PURE__*/React.createElement(\"h2\",null,\"Numbers\"),persons.filter(function(contact){return contact.name.toLowerCase().includes(filterName);}).map(function(contact,i){return/*#__PURE__*/React.createElement(Persons,{key:i,person:contact,removedPerson:function removedPerson(){if(window.confirm(\"Delete \".concat(contact.name,\" ?\")))_removedPerson(contact.id);}});}));};ReactDOM.render(/*#__PURE__*/React.createElement(App,null),document.getElementById('root'));","map":{"version":3,"sources":["/Users/khanglethanh/fullstack_open/part2/phonebook/src/index.js"],"names":["React","useState","useEffect","ReactDOM","Filter","PersonForm","Persons","Notification","personService","App","persons","setPersons","name","number","newInfo","setNewInfo","filterName","setFilterName","successMessage","setSuccessrMessage","errorMessage","setErrorMessage","console","log","getAll","then","initialPersons","handleFilter","newValue","handleChange","event","value","target","addPerson","preventDefault","undefined","some","person","answer","window","confirm","find","n","changedInfo","update","id","returnedPerson","map","setTimeout","catch","error","filter","personObject","create","concat","response","data","removedPerson","deletedPerson","deleteId","Object","keys","length","contact","toLowerCase","includes","i","render","document","getElementById"],"mappings":"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","sourcesContent":["import React, { useState,  useEffect } from 'react'\nimport ReactDOM from 'react-dom'\nimport Filter from './component/Filter'\nimport PersonForm from './component/PersonForm'\nimport Persons from './component/Persons'\nimport Notification from './component/Notification'\n\nimport personService from './services/persons'\nimport './index.css'\nconst App = () => {\n  const [ persons, setPersons ] = useState([]) \n  const [ newInfo, setNewInfo] = useState({\n    name: \"\",\n    number: \"\"\n  })\n  const [filterName, setFilterName] = useState('')\n  const [successMessage, setSuccessrMessage] = useState('')\n  const [errorMessage, setErrorMessage] = useState('')\n\n  useEffect(() => {\n    console.log('effect')\n    setSuccessrMessage(null)\n    setErrorMessage(null)\n    personService\n      .getAll()\n      .then(initialPersons => {\n        setPersons(initialPersons)\n      })\n      \n  }, [])\n  const handleFilter = (newValue)=> {\n    setFilterName(newValue)  \n    \n  }\n  const handleChange = (event) => {\n    const value = event.target.value;\n    setNewInfo({\n      ...newInfo,\n      [event.target.name]: value\n    });\n  }\n  const addPerson = (event) => {\n    event.preventDefault()\n    \n    if(newInfo.name !== undefined){\n      \n      if(persons.some(person => person.name === newInfo.name)){\n        let answer = window.confirm(`${newInfo.name} is already added to phonebook, replace the old number with a new one?`);\n        const person = persons.find(n => n.name === newInfo.name)\n        const changedInfo = { ...person, number: newInfo.number}\n        if(answer === true){\n          personService\n              .update(changedInfo.id, changedInfo)\n              .then(returnedPerson => {\n                setPersons(persons.map(person => person.id !== changedInfo.id ? person : returnedPerson))\n                setSuccessrMessage(`User ${newInfo.name} has changed number to: ${newInfo.number}`)\n                setTimeout(() => {\n                  setSuccessrMessage(null)\n                }, 5000)\n               \n              })\n              .catch(error => {\n                console.log(error)\n                setPersons(persons.filter(person => person.id !== changedInfo.id))\n                setErrorMessage(`Information of ${newInfo.name} has already been removed from server`)\n                setTimeout(() => {\n                  setErrorMessage(null)\n                }, 5000)\n              }) \n        }  \n      } \n      else{\n        const personObject = {\n          name: newInfo.name,\n          number: newInfo.number\n        } \n        personService\n          .create(personObject)\n          .then(returnedPerson => {\n            console.log(\"i\")\n            setPersons(persons.concat(returnedPerson))\n            setNewInfo('')\n            setSuccessrMessage(`Added ${newInfo.name}`)\n            setTimeout(() => {\n              setSuccessrMessage(null)\n            }, 5000)\n    \n          })\n          .catch(error => {\n            console.log(error.response.data.error)\n            setErrorMessage(error.response.data.error)\n          })\n           \n        \n      }\n    }\n  }\n  const removedPerson = id => {\n    const person = persons.find(person => person.id === id)\n    const deletedPerson = { ...person}\n\n    personService\n      .deleteId(id, deletedPerson)\n      .then(returnedPerson => {\n        setPersons(persons.map(person => person.id !== id ? person : returnedPerson).filter(value => Object.keys(value).length !== 0))\n      })\n    \n  }\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      <Notification success_message={successMessage} error_message={errorMessage}/>\n      <Filter  value={filterName} onChange={handleFilter}/>\n      <h2>add a new</h2>\n      <PersonForm values={newInfo} onChange={handleChange} onSubmit={addPerson} />  \n      <h2>Numbers</h2>\n      {persons\n        .filter( contact =>contact.name.toLowerCase().includes(filterName)) \n        .map((contact, i) => \n          <Persons\n            key={i}\n            person={contact} \n            removedPerson={() => {if (window.confirm(`Delete ${contact.name} ?`)) removedPerson(contact.id)}}\n          />\n      )}\n        \n    </div>\n  )\n}\n\nReactDOM.render(<App />, \n  document.getElementById('root')\n)"]},"metadata":{},"sourceType":"module"}